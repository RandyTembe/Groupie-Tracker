<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Détails du groupe</title>
  <link rel="stylesheet" href="/static/CSS/notes.css">
  <link rel="stylesheet" href="/static/CSS/image.css">
  <style>
    .artist-container { max-width:900px; margin:28px auto; padding:20px; color:#fff }
    .artist-header { display:flex; align-items:center; gap:16px; margin-bottom:16px }
    .artist-image { width:140px; height:140px; background-size:cover; background-position:center; border-radius:8px }
    .artist-name { font-size:1.8rem; font-weight:700 }
    .raw-json-pre { white-space:pre-wrap; max-height:640px; overflow:auto; background:#f7f7f7; color:#111; border-radius:6px; padding:12px; font-family:monospace }
    a.back-link { color:#83a3fc; text-decoration:none; margin-bottom:12px; display:inline-block }
  </style>
</head>
<body>
  <div class="artist-container">
    <a class="back-link" href="/">← Retour</a>
    <div id="artistRoot">
      <div class="artist-header">
        <div id="artistImage" class="artist-image" aria-hidden="true"></div>
        <div>
          <div id="artistName" class="artist-name">Chargement…</div>
          <div id="artistMeta" style="margin-top:8px;color:#ddd"></div>
        </div>
      </div>
      <h3>JSON brut</h3>
      <pre id="rawJsonPre" class="raw-json-pre">Chargement…</pre>
    </div>
  </div>

  <script>
    (function(){
      function q(sel){return document.querySelector(sel)}
      function escapeHtml(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}
      // extract id from path /artists/:id
      const path = window.location.pathname || '';
      const id = path.replace(/^\/artists\/?/, '') || new URLSearchParams(window.location.search).get('id');
      if (!id) {
        q('#artistName').textContent = 'ID manquant';
        q('#rawJsonPre').textContent = 'Aucun ID fourni';
        return;
      }
      fetch('/api/artists/' + encodeURIComponent(id))
        .then(r=>r.ok ? r.json() : Promise.reject('not found'))
        .then(data => {
          q('#artistName').textContent = data.name || data.Name || '—';
          q('#artistMeta').textContent = (data.creationDate ? 'Créé en ' + data.creationDate : '') + (data.firstAlbum ? (' • Premier album: ' + data.firstAlbum) : '');
          if (data.image || data.Image) q('#artistImage').style.backgroundImage = 'url("' + (data.image||data.Image) + '")';
          q('#rawJsonPre').innerHTML = escapeHtml(JSON.stringify(data, null, 2));
        })
        .catch(err=>{
          q('#artistName').textContent = 'Erreur';
          q('#rawJsonPre').textContent = String(err);
        });
    })();
  </script>
</body>
</html>
