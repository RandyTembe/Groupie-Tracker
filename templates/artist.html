<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Détails du groupe</title>
  <link rel="stylesheet" href="/static/CSS/notes.css">
  <link rel="stylesheet" href="/static/CSS/image.css">
  <style>
    .artist-container { max-width:900px; margin:28px auto; padding:20px; color:#fff }
    .artist-header { display:flex; align-items:center; gap:16px; margin-bottom:16px }
    .artist-image { width:140px; height:140px; background-size:cover; background-position:center; border-radius:8px }
    .artist-name { font-size:1.8rem; font-weight:700 }
    .raw-json-pre { white-space:pre-wrap; max-height:640px; overflow:auto; background:#f7f7f7; color:#111; border-radius:6px; padding:12px; font-family:monospace }
    /* back button styled as a fixed, accessible control */
    .back-link {
      position: fixed;
      top: 12px;
      left: 12px;
      z-index: 1100;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.92);
      color: #111;
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.12);
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
    }
    .back-link:focus {
      outline: 3px solid rgba(131,163,252,0.35);
      outline-offset: 2px;
    }
    .back-link:hover { transform: translateY(-1px); }
  </style>
</head>
<body>
  <div class="artist-container">
    <button id="backBtn" class="back-link" type="button">← Retour</button>
    <div id="artistRoot">
      <div class="artist-header">
        <div id="artistImage" class="artist-image" aria-hidden="true"></div>
        <div>
          <div id="artistName" class="artist-name">Chargement…</div>
          <div id="artistMeta" style="margin-top:8px;color:#ddd"></div>
        </div>
      </div>
      <h3>Infos :</h3>
      <pre id="rawJsonPre" class="raw-json-pre">Chargement…</pre>
    </div>
  </div>

  <script>
    (function(){
      function q(sel){return document.querySelector(sel)}
      // back button behaviour: try history.back(), fallback to homepage
      const _back = function() {
        if (history.length > 1) history.back(); else window.location.href = '/';
      };
      const btn = q('#backBtn'); if (btn) btn.addEventListener('click', _back);
      function escapeHtml(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}
      // extract id from path /artists/:id
      const path = window.location.pathname || '';
      const id = path.replace(/^\/artists\/?/, '') || new URLSearchParams(window.location.search).get('id');
      if (!id) {
        q('#artistName').textContent = 'ID manquant';
        q('#rawJsonPre').textContent = 'Aucun ID fourni';
        return;
      }
      fetch('/api/artists/' + encodeURIComponent(id))
        .then(r=>r.ok ? r.json() : Promise.reject('not found'))
        .then(data => {
          q('#artistName').textContent = data.name || data.Name || '—';
          q('#artistMeta').textContent = (data.creationDate ? 'Créé en ' + data.creationDate : '') + (data.firstAlbum ? (' • Premier album: ' + data.firstAlbum) : '');
          if (data.image || data.Image) q('#artistImage').style.backgroundImage = 'url("' + (data.image||data.Image) + '")';
          q('#rawJsonPre').innerHTML = escapeHtml(JSON.stringify(data, null, 2));
        })
        .catch(err=>{
          q('#artistName').textContent = 'Erreur';
          q('#rawJsonPre').textContent = String(err);
        });
    })();
  </script>
</body>
</html>
